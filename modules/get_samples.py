import os
from .. import settings
from preprocess_module import get_sha1
from preprocess_module import is_file_size_valid
from shutil import copyfile

def get_benign_samples():
    for subdir, dirs, files in os.walk(settings.benign_search_path):
        for file in files:
            if os.path.splitext(file)[1] in ['.exe', '.dll'] and is_file_size_valid(os.path.join(subdir, file)):
                copyfile(os.path.join(subdir, file),
                         os.path.join(settings.samples_benign_dir, get_sha1(os.path.join(subdir, file))))